{"ast":null,"code":"import fs from 'node:fs';\nconst path = require(\"path\");\nconst express = require(\"express\");\nconst multer = require(\"multer\");\nconst {\n  google\n} = require(\"googleapis\");\nconst app = express();\nconst PORT = 5000;\n\n// Service Account JSON betÃ¶ltÃ©se\nconst auth = new google.auth.GoogleAuth({\n  keyFile: \"./bookieimage.json\",\n  // A JSON fÃ¡jl neve\n  scopes: [\"https://www.googleapis.com/auth/drive.file\"]\n});\n\n// Google Drive API inicializÃ¡lÃ¡sa\nconst drive = google.drive({\n  version: \"v3\",\n  auth\n});\n\n// Multer beÃ¡llÃ­tÃ¡sa (fÃ¡jlfeltÃ¶ltÃ©s)\nconst upload = multer({\n  dest: \"uploads/\"\n});\n\n// ðŸ“Œ FÃ¡jl feltÃ¶ltÃ©se a Drive-ra\napp.post(\"/upload\", upload.single(\"file\"), async (req, res) => {\n  try {\n    const fileMetadata = {\n      name: req.file.originalname,\n      parents: [\"1rTc9ThTwwMPcwmwitlLAul4xT-g_3ebb\"] // Itt a Drive mappa ID-jÃ¡t add meg!\n    };\n    const media = {\n      mimeType: req.file.mimetype,\n      body: fs.createReadStream(req.file.path)\n    };\n    const file = await drive.files.create({\n      resource: fileMetadata,\n      media: media,\n      fields: \"id\"\n    });\n\n    // TÃ¶rÃ¶ljÃ¼k a feltÃ¶ltÃ¶tt fÃ¡jlt a szerverrÅ‘l\n    fs.unlinkSync(req.file.path);\n    res.status(200).json({\n      fileId: file.data.id,\n      link: `https://drive.google.com/uc?id=${file.data.id}`\n    });\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({\n      error: \"FeltÃ¶ltÃ©si hiba\"\n    });\n  }\n});\n\n// Szerver indÃ­tÃ¡sa\napp.listen(PORT, () => console.log(`âœ… Szerver fut a ${PORT} porton`));","map":{"version":3,"names":["fs","path","require","express","multer","google","app","PORT","auth","GoogleAuth","keyFile","scopes","drive","version","upload","dest","post","single","req","res","fileMetadata","name","file","originalname","parents","media","mimeType","mimetype","body","createReadStream","files","create","resource","fields","unlinkSync","status","json","fileId","data","id","link","error","console","listen","log"],"sources":["F:/NagyProjekt/bookie/src/components/assets/scripts/uploadimage.js"],"sourcesContent":["import fs from 'node:fs';\r\n\r\nconst path = require(\"path\");\r\nconst express = require(\"express\");\r\nconst multer = require(\"multer\");\r\nconst { google } = require(\"googleapis\");\r\n\r\nconst app = express();\r\nconst PORT = 5000;\r\n\r\n// Service Account JSON betÃ¶ltÃ©se\r\nconst auth = new google.auth.GoogleAuth({\r\n    keyFile: \"./bookieimage.json\", // A JSON fÃ¡jl neve\r\n    scopes: [\"https://www.googleapis.com/auth/drive.file\"],\r\n});\r\n\r\n// Google Drive API inicializÃ¡lÃ¡sa\r\nconst drive = google.drive({ version: \"v3\", auth });\r\n\r\n// Multer beÃ¡llÃ­tÃ¡sa (fÃ¡jlfeltÃ¶ltÃ©s)\r\nconst upload = multer({ dest: \"uploads/\" });\r\n\r\n// ðŸ“Œ FÃ¡jl feltÃ¶ltÃ©se a Drive-ra\r\napp.post(\"/upload\", upload.single(\"file\"), async (req, res) => {\r\n    try {\r\n        const fileMetadata = {\r\n            name: req.file.originalname,\r\n            parents: [\"1rTc9ThTwwMPcwmwitlLAul4xT-g_3ebb\"], // Itt a Drive mappa ID-jÃ¡t add meg!\r\n        };\r\n\r\n        const media = {\r\n            mimeType: req.file.mimetype,\r\n            body: fs.createReadStream(req.file.path),\r\n        };\r\n\r\n        const file = await drive.files.create({\r\n            resource: fileMetadata,\r\n            media: media,\r\n            fields: \"id\",\r\n        });\r\n\r\n        // TÃ¶rÃ¶ljÃ¼k a feltÃ¶ltÃ¶tt fÃ¡jlt a szerverrÅ‘l\r\n        fs.unlinkSync(req.file.path);\r\n\r\n        res.status(200).json({ fileId: file.data.id, link: `https://drive.google.com/uc?id=${file.data.id}` });\r\n    } catch (error) {\r\n        console.error(error)\r\n        res.status(500).json({ error: \"FeltÃ¶ltÃ©si hiba\" })\r\n    }\r\n});\r\n\r\n// Szerver indÃ­tÃ¡sa\r\napp.listen(PORT, () => console.log(`âœ… Szerver fut a ${PORT} porton`));"],"mappings":"AAAA,OAAOA,EAAE,MAAM,SAAS;AAExB,MAAMC,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAM;EAAEG;AAAO,CAAC,GAAGH,OAAO,CAAC,YAAY,CAAC;AAExC,MAAMI,GAAG,GAAGH,OAAO,CAAC,CAAC;AACrB,MAAMI,IAAI,GAAG,IAAI;;AAEjB;AACA,MAAMC,IAAI,GAAG,IAAIH,MAAM,CAACG,IAAI,CAACC,UAAU,CAAC;EACpCC,OAAO,EAAE,oBAAoB;EAAE;EAC/BC,MAAM,EAAE,CAAC,4CAA4C;AACzD,CAAC,CAAC;;AAEF;AACA,MAAMC,KAAK,GAAGP,MAAM,CAACO,KAAK,CAAC;EAAEC,OAAO,EAAE,IAAI;EAAEL;AAAK,CAAC,CAAC;;AAEnD;AACA,MAAMM,MAAM,GAAGV,MAAM,CAAC;EAAEW,IAAI,EAAE;AAAW,CAAC,CAAC;;AAE3C;AACAT,GAAG,CAACU,IAAI,CAAC,SAAS,EAAEF,MAAM,CAACG,MAAM,CAAC,MAAM,CAAC,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC3D,IAAI;IACA,MAAMC,YAAY,GAAG;MACjBC,IAAI,EAAEH,GAAG,CAACI,IAAI,CAACC,YAAY;MAC3BC,OAAO,EAAE,CAAC,mCAAmC,CAAC,CAAE;IACpD,CAAC;IAED,MAAMC,KAAK,GAAG;MACVC,QAAQ,EAAER,GAAG,CAACI,IAAI,CAACK,QAAQ;MAC3BC,IAAI,EAAE5B,EAAE,CAAC6B,gBAAgB,CAACX,GAAG,CAACI,IAAI,CAACrB,IAAI;IAC3C,CAAC;IAED,MAAMqB,IAAI,GAAG,MAAMV,KAAK,CAACkB,KAAK,CAACC,MAAM,CAAC;MAClCC,QAAQ,EAAEZ,YAAY;MACtBK,KAAK,EAAEA,KAAK;MACZQ,MAAM,EAAE;IACZ,CAAC,CAAC;;IAEF;IACAjC,EAAE,CAACkC,UAAU,CAAChB,GAAG,CAACI,IAAI,CAACrB,IAAI,CAAC;IAE5BkB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,MAAM,EAAEf,IAAI,CAACgB,IAAI,CAACC,EAAE;MAAEC,IAAI,EAAE,kCAAkClB,IAAI,CAACgB,IAAI,CAACC,EAAE;IAAG,CAAC,CAAC;EAC1G,CAAC,CAAC,OAAOE,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACpBtB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEK,KAAK,EAAE;IAAkB,CAAC,CAAC;EACtD;AACJ,CAAC,CAAC;;AAEF;AACAnC,GAAG,CAACqC,MAAM,CAACpC,IAAI,EAAE,MAAMmC,OAAO,CAACE,GAAG,CAAC,mBAAmBrC,IAAI,SAAS,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}